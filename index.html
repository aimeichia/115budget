import React, { useState } from 'react';
import { 
  CloudSun, Microchip, Users, ShieldAlert, Database, 
  Droplets, TowerControl as Tower, Wind, Activity, 
  FileText, MapPin, ChevronRight, AlertTriangle, 
  Anchor, Robot, Car, Zap, Search, Info
} from 'lucide-react';

const App = () => {
  const [activeTab, setActiveTab] = useState('人事室');
  const [activeProject, setActiveProject] = useState('P7');
  const [activeQA, setActiveQA] = useState('q_act');
  const [searchTerm, setSearchTerm] = useState('');

  // --- DATA 1: STRATEGIC PROJECTS (D-VERSION FULL 9 PROJECTS - ENRICHED) ---
  const strategicProjects = [
    { 
      id: 'P7', name: '氣象風險數位治理與跨域應用創新(P7)', budget: '325,000', owner: '科技發展組', icon: <Microchip size={20} />, 
      works: [
        '精進科研發展：精進數值預報技術，導入 AI 測報作業應用，提升極端天氣之預警效能並接軌國際合作。', 
        '強化數位轉型：推動國家級氣象資料治理與整合、AI 就緒資科擴充、資料服務效能升級及跨域應用。', 
        '提升智慧服務：持續優化智慧化氣象署公衆服務系統或平台，以提升氣象公眾服務與傳遞效能。'
      ], 
      kpi: '100% 執行率', 
      benefit: '解決 1-14 天預報斷層，將氣象數據轉化為決策價值，協助農工交能各界規避氣候風險。',
      risk: '115年為研發與驗證關鍵年。若預算未審議完成，模式研發、測試與解析度提升將全面停滯，預報誤差難以改善。AI 模式需長期累積驗證，若中斷將削弱防災可靠度與風險管理成效。'
    },
    { 
      id: 'CABLE', name: '建置南部海域海纜觀測系統 (第3次修正)', budget: '152,462', owner: '地震測報中心', icon: <Activity size={20} />, 
      works: [
        '執行第 3 次修正計畫：積極洽詢具投標意願廠商，針對 114 年 1 月專家研商需求重啟採購。', 
        '外部環境因應：克服新冠肺炎、物價飆漲(40%)、南海局勢緊張及國際廠商政策轉變等 12 次流標因素。', 
        '維運現有站點：維持南部海纜既有站點與陸上資料接收站之穩定維運。'
      ], 
      kpi: '洽廠商重啟招標作業', 
      benefit: '完工後可爭取南部地區 10-20 秒地震預警時間，實質減輕強震災害損害。',
      risk: '持續流標或預算延宕將導致南部海域地震觀測盲區持續存在，延誤救災與早期預警之關鍵先機。'
    },
    { 
      id: 'O_MAINT', name: '外洋海氣象觀測維運計畫', budget: '45,500', owner: '海象氣候組', icon: <Anchor size={20} />, 
      works: [
        '更換浮標錨繫：每年更換所需設備以防止浮標漂流，屬極高度急迫性之常態性維護。', 
        '備品整備與修繕：確保海上儀器受損之足量備品更換與毀壞修復。', 
        '連續資料回傳：維持 24/7 連續性海象觀測資料，避免天氣預警與航安資料中斷。'
      ], 
      kpi: '資料妥善率 95%', 
      benefit: '保障全台天氣預警、航行安全、海上遊憩及漁業活動之核心數據支撐。',
      risk: '高度急迫項目。倘預算未審核動支，將無法更新錨繫，造成浮標漂流及資料斷訊，嚴重影響航安。'
    },
    { 
      id: 'AI_SERV', name: '氣象創新 AI 服務子計畫 (智慧政府)', budget: '21,763', owner: '科技發展組', icon: <Robot size={20} />, 
      works: [
        '建置 AI 多語服務：導入氣象圖資解說、氣象問答多語服務系統。', 
        '自動化預報研發：產製短時降雨自動化預報，並研發預報作業助手。', 
        '監測技術提升：監測溫室氣體分布，強化氣象服務之韌性與資料便捷解讀。'
      ], 
      kpi: '服務韌性提升 30%', 
      benefit: '強化智慧政府數位化轉型，優化公眾對劇烈天氣圖資之理解與決策便捷度。',
      risk: '新興計畫若未能動支，將延誤氣象資訊便捷化、口語化解說轉型，降低公眾預警訊息吸收率。'
    },
    { id: 'HPC', name: '數值天氣測報高速運算電腦 (HPC)', budget: '345,903', owner: '數值資訊組', icon: <Database size={20} />, works: ['建置 GPU 高效算力核心，導入 AI 預報模型產製', '第6代電腦可用率維持 99.9%', '新竹氣象科技園區完成細部設計與發包'], kpi: '99.9% 可用', benefit: '支援國家級 AI 氣象運算核心。', risk: '分期款給付延宕將面臨軟硬體維護中止與商譽風險。' },
    { id: 'R', name: '精進氣象雷達與災防預警 (R計畫)', budget: '339,650', owner: '海氣遙測組', icon: <Tower size={20} />, works: ['支付金門馬祖雷達設備採購分期款', '馬祖雷達站房監造工程與金門站房規劃'], kpi: '95% 妥善', benefit: '補足西部觀測盲區，強化離島預警能量。', risk: '離島災防防線建置停擺，盲區劇烈天氣威胁持續存在。' },
    { id: 'O_STRAT', name: '智慧海象治理與氣候韌性 (O計畫)', budget: '388,590', owner: '海象氣候組', icon: <Droplets size={20} />, works: ['佈建智慧海象浮標網', '建立臺灣乾旱整合資訊平臺支援抗旱'], kpi: '95% 妥善', benefit: '協助政府精準抗旱與調適氣候風險。', risk: '乾旱預警建置延誤將直接影響國家水資源調度決策品質。' },
    { 
      id: 'DRONE', name: '無人載具產業發展統籌型計畫', budget: '2,724', owner: '大氣觀測組', icon: <Wind size={20} />, 
      works: ['引進無人機進行氣象站房自動化巡檢作業', '開發無人載具之垂直大氣剖面觀測應用', '建立無人載具監控流程'], 
      kpi: '巡檢覆蓋率 100%', 
      benefit: '提升偏遠站房巡檢安全性與效率，精進觀測數據密度。',
      risk: '巡檢自動化轉型停滯，增加人工巡檢偏遠站點之風險。'
    },
    { id: 'VEHICLE', name: '行政設備升級 (首長車與充電椿)', budget: '3,136', owner: '人事室/秘書室', icon: <Car size={20} />, works: ['購置首長專用公務車', '建置配套充電椿及基礎設施'], kpi: '100% 妥善', benefit: '確保災防緊急動員指揮機動力。', risk: '行政機動性受限。' }
  ];

  // --- DATA 2: ALL 11 UNITS (EXHAUSTIVE) ---
  const units = [
    { 
      id: '人事室', icon: <Users size={16} />, budget_info: '829,078k (+17,815k)',
      full_okr: '1. 考量考績晉級與 114 年軍公教調薪經費，覈實編列人事費。<br>2. 提升員工專業知能，強化管理職能並營造友善職場。<br>3. 辦理行政設備升級，確保緊急災防機動能力。', 
      kpis: [{t:'員額總計', v:'649人'}, {t:'退休潮', v:'36人'}, {t:'執行率', v:'95.2%'}], 
      details: [
        {k: '員額詳細組成', v: '職員 586, 駐警 4, 工友 21, 技工 1, 駕駛 11, 聘用 21, 約僱 5'},
        {k: '新興行政項', v: '首長專用車及充電椿 (3,136k)'},
        {k: '預算增額因素', v: '114 年軍公教調薪 4% 經費於 115 年須由本署預算自行支應。'}
      ],
      benefit: '穩固本署人才資源，確保測報與災防核心業務持續運算不中斷。', source: '人事室 PPT / 1223底稿' 
    },
    { 
      id: '預報中心', icon: <CloudSun size={16} />, budget_info: '77,189k (-35,039k)',
      full_okr: '1. 辦理 24H 天氣測報、警報產製及在地化氣象服務。<br>2. 推動 368 鄉鎮精緻化天氣預報自動產出與即時預警。<br>3. 研發劇烈天氣自動繪圖效率提升 50%。', 
      kpis: [{t:'精度提升', v:'15%'}, {t:'製圖效率', v:'+50%'}], 
      details: [
        {k: '預算變動原因', v: '減少 35,039 千元，主因部分系統維運預算移撥數值組統籌整合。'},
        {k: '核心任務', v: '維持 368 鄉鎮級大雷雨、強風等劇烈天氣即時發布。'}
      ],
      benefit: '提供公眾精準在地預報，落實防災預警功能，保障民眾安全。', source: '主計室 / A版本回填' 
    },
    { 
      id: '科技發展組', icon: <Microchip size={16} />, budget_info: '229,690k (+73,387k)',
      full_okr: '1. 統籌 P7 計畫開發 AI 模式解決預報斷層。<br>2. 推動氣象創新 AI 智慧政府服務子計畫。<br>3. 辦理產學研技術交流聯繫與太空天氣資料應用。', 
      kpis: [{t:'交流場次', v:'12場'}, {t:'計畫執行', v:'100%'}], 
      details: [
        {k: 'AI 子計畫', v: '21,763k (智慧政府新興項)'},
        {k: 'P7 計畫核心', v: '科研發展、數位轉型、智慧服務'}
      ],
      benefit: '整合產學研能量，提升測報數位韌性，將數據轉化為決策價值。', source: '調查表 / 1224模擬題' 
    },
    { 
      id: '數值資訊組', icon: <Database size={16} />, budget_info: '716,108k (+190,090k)',
      full_okr: '1. 執行 HPC 六期建設。<br>2. 新竹氣象科技園區土建細部設計。<br>3. 維運即時資料供應平臺 (PDS) 與氣象資訊系統。', 
      kpis: [{t:'HPC可用', v:'99.9%'}, {t:'PDS效能', v:'+20%'}], 
      details: [
        {k: '全署增額首位', v: '+1.9 億元'},
        {k: '重點工程', v: 'GPU 電腦硬體建置與新竹園區規劃'}
      ],
      benefit: '強化全台氣象算力，支援高解析 AI 預報模式作業化應用。', source: '主計室' 
    },
    { id: '海氣遙測組', icon: <Tower size={16} />, budget_info: '298,806k (+108,404k)', full_okr: '1. 推動 R 計畫完成金馬雷達。 2. 維護全台雷達網妥善。', kpis: [{t:'雷達妥善', v:'95%'}], details: [{k: '離島預警', v: '補足西部觀測盲區'}, {k: '增額主因', v: '雷達採購付款高峰'}], benefit: '離島劇烈天氣預報。', source: '主計室' },
    { id: '海象氣候組', icon: <Droplets size={16} />, budget_info: '342,635k (+58,802k)', full_okr: '1. 外洋海象觀測維運。 2. 乾旱平臺整合支援。', kpis: [{t:'平臺建設', v:'1套'}], details: [{k: '急迫性', v: '更換浮標錨繫(45,500k)'}, {k: '風險', v: '預算未過資料將斷訊'}], benefit: '保障導航與漁業安全。', source: '1223會議底稿' },
    { id: '大氣觀測組', icon: <Wind size={16} />, budget_info: '256,014k (+66,085k)', full_okr: '1. 維護全國觀測站網。 2. 開發 UAV 巡檢與剖面觀測。', kpis: [{t:'測站妥善', v:'98%'}], details: [{k: '無人機計畫', v: '2,724k'}, {k: '數據提供', v: '模式初始場數據核心'}], benefit: '確保基礎觀測品質。', source: '主計室' },
    { 
      id: '地震測報中心', icon: <Activity size={16} />, budget_info: '152,462k (+5,532k)', 
      full_okr: '1. 維護全國地震監測網。 2. 精進南部海纜觀測系統(第3次修正)。 3. AI 自動定位技術。', 
      kpis: [{t:'預警時效', v:'精進'}, {t:'修正進度', v:'第3次'}], 
      details: [
        {k: '流標說明', v: '12次流標主因疫情、物價、南海局勢'},
        {k: '現況', v: '已有廠商具投標意願並提供報價'}
      ], 
      benefit: '縮短強震警報秒數。', source: '1224模擬題' 
    },
    { id: '秘書室', icon: <FileText size={16} />, budget_info: '67,683k (+1,855k)', full_okr: '1. 行政事務與採購流程管理。 2. 協助重大科技計畫發包管考。', kpis: [{t:'採購合格', v:'100%'}], details: [{k: '資產管理', v: '維護署區環境安全'}], benefit: '確保行政高效運作。', source: '主計室' },
    { id: '南區中心', icon: <MapPin size={16} />, budget_info: '20,302k (+759k)', full_okr: '1. 南部區域氣象監測。 2. 在地災防宣導科普。', kpis: [{t:'設備妥善', v:'95%'}], details: [{k: '區域預警', v: '深耕南台灣防災'}], benefit: '落實在地化服務。', source: '主計室' },
    { id: '綜合規劃組', icon: <Search size={16} />, budget_info: '14,099k (+1,131k)', full_okr: '1. 計畫研考與氣象法修正。 2. 氣象國際聯繫與聯繫合作。', kpis: [{t:'研考管考', v:'100%'}], details: [{k: '法制重點', v: '太空天氣、高溫納入災害性天氣'}], benefit: '完善施政目標管理。', source: '1224模擬題' }
  ];

  // --- DATA 3: FULL QA ARCHIVE (TOTALLY RE-FILLED, NO OMISSION, 11 ITEMS) ---
  const fullQA = [
    { 
      id: 'q_act', title: '氣象法修正草案重點說明 (D版本全記錄)', 
      issue: '財委會模擬題：為因應氣候變遷與災防需求，氣象法修正之具體重點為何？', 
      question: '氣象法修正有哪些強化方向？太空天氣納入意義為何？', 
      answer: '1. **強化範疇**：將熱帶性低氣壓、高溫及「太空天氣」正式納入災害性天氣與氣象業務範疇。\n2. **完善發布**：新增氣象分析與研判結果發布之報告機制。\n3. **精進質量**：新增約用觀測站合作契約、觀測儀器分級制度。\n4. **促進產業**：推動產業人才能力鑑定、建立資源合作協定。\n5. **進度**：刻正辦理通報行政院作業，待核可後報院審議。', 
      source: '1141224 模擬題' 
    },
    { 
      id: 'q_cable_hist', title: '南部海纜計畫 12 次流標原因與現況', 
      issue: '財委會模擬題：南部海域海纜案進度修正頻繁，流標原因與現況為何？', 
      question: '海纜案為何流標 12 次？目前辦理進度與成效？', 
      answer: '1. **外部主因**：自 110 年辦理採購以來，受新冠肺炎疫情、物價費用飆漲 (40%+)、南海中菲情勢緊張、國際佈纜船租期排程及廠商政策轉變影響。\n2. **積極作為**：已辦理 2 次修正。114 年 1 月邀專家研商後，已有廠商具投標意願並提供參考報價，正辦理第 3 次修正計畫作業。\n3. **效益**：完工後可爭取南部 10-20 秒預警時間，實質提升減災能量。', 
      source: '1141224 模擬題' 
    },
    { 
      id: 'q_risk', title: '決策風險：預算未能依限通過之不利影響', 
      issue: '1223 修正修正底稿：115 年新興/新增計畫若延宕，對核心業務有何具體衝擊？', 
      question: '若預算無法依限通過，對氣象署有何實質傷害？', 
      answer: '1. **科研中斷**：P7 計畫為研發關鍵期，中斷將使 AI 驗證資料斷層，模式研發停滯，預報誤差難以改善，降低預警品質。\n2. **航安威脅**：外洋觀測浮標 (4,550萬) 若無預算更換錨繫，浮標恐漂流斷訊，嚴重威脅海上航行、漁業與救災安全。\n3. **因應措施**：將視預算優先支撐常態維修，涉及設備汰換之新興項目調整採購期程辦理。', 
      source: '1223 修正底稿' 
    },
    { 
      id: 'q_hr1', title: '人事費增列原因與 114 年退休潮影響', 
      issue: '立院質詢：115 人事費 8.29 億較去年增加，理由為何？', 
      question: '人事費增編理由？114 年執行率僅 95.2% 之理由？', 
      answer: '1. **增編主因**：考量「考績晉級」俸額提升，及「114 年軍公教待遇調增 4%」之 115 年機關預算自行編列支應。\n2. **執行率分析**：114 年預估執行率為 95.20%，主因受「退休潮」影響，114 年退休達 36 人，致部分薪俸賸餘。115 年預算依 649 名編制需求覈實編列，無浮編情事。', 
      source: '人事室 PPT' 
    },
    { 
      id: 'q_forecast', title: '預報中心預算減少 3,503 萬元之因應', 
      issue: '立院質詢：預報預算縮減是否影響鄉鎮預警品質？', 
      question: '115 預報預算減少主因？如何維持能量？', 
      answer: '1. **預算整合**：減少主因是資訊維運預算移撥數值組統籌整合，並非業務縮減。\n2. **品質保證**：中心將專注於 368 鄉鎮精緻預報與自動化警報，減災功能完全不受影響，技術發展更趨高效作業化。', 
      source: '主計室 115 簡表' 
    },
    { id: 'q_hr2', title: '出國計畫內容重複性質疑答詢', issue: '出國研習多與往年相同，效益何在？', question: '如何回應重複性質疑？', answer: '長期交流旨在精進 AI 預報、地震海纜與火山監測技術。116 年將配合組改業務變動，重新核實規劃計畫名稱，使其精確反映年度技術重點與產出。', source: '人事室 PPT' },
    { id: 'q_hr3', title: '大陸旅費恢復編列理由 (7.5萬)', issue: '大陸旅費較去年增加 4 倍？是否浮濫？', question: '恢復預算規模之理由？', answer: '114 年遭刪減至 1.5 萬致無法支應交流旅費，致該年未執行。115 年恢復原政院核定規模 7.5 萬，用於掌握兩岸氣象地震監測技術動態，具重要資訊價值。', source: '人事室 PPT' },
    { id: 'q_p7', title: 'AI 科技計畫 (P7) 必要性與驗證挑戰', issue: '新增 3.25 億計畫，AI 是否能解決誤差？', question: '核心用途為何？AI 能否取代物理模式？', answer: '採 Hybrid 策略。重點在解決 1-14 天預報斷層，產製農、工、交、能決策價值。115 年若預算延誤，AI 累積驗證資料斷層將削弱防災可靠度。', source: '委員調查表' },
    { id: 'q_radar', title: '雷達計畫預算增額與離島防災', issue: '遙測預算增列 1.08 億之原因？', question: '預算翻倍理由？離島防線完工期？', answer: '進入 4 部雷達採購付款高峰與馬祖站房土建。完工後可監測西部海域移入盲區，提升離島劇烈對流早期預警時效，實質填補國家測報缺口。', source: '預擬答題 PDF' },
    { id: 'q_seismic', title: '海纜計畫進度延宕因應作為', issue: '海纜案進度修正頻繁？是否有成效？', question: '115 年如何保證成效？', answer: '已調整採購策略，選用強化型海纜並修正鋪設路徑。115 年進入海底鋪設作業高峰，目標完工後爭取南部 10-20 秒預警時間，強化國土韌性。', source: '預擬答題 PDF' },
    { id: 'q_ai_serv', title: 'AI 智慧政府服務子計畫效益', issue: '新興計畫 2,176 萬，與 P7 計畫之區隔？', question: 'AI 服務子計畫之核心目標？', answer: '主攻「智慧服務」。包含多語氣象問答、圖資解說及降雨自動預報，旨在提升民眾獲取資訊之便捷性，落實智慧政府數位轉型。', source: '委員調查表' }
  ];

  // --- RENDER LOGIC ---
  const currentUnit = units.find(u => u.id === activeTab) || units[0];
  const currentProj = strategicProjects.find(p => p.id === activeProject) || strategicProjects[0];
  const currentQA = fullQA.find(q => q.id === activeQA) || fullQA[0];

  const filteredQA = fullQA.filter(q => 
    q.title.toLowerCase().includes(searchTerm.toLowerCase()) || 
    q.answer.toLowerCase().includes(searchTerm.toLowerCase())
  );

  return (
    <div className="flex flex-col min-h-screen bg-slate-50">
      {/* Navbar */}
      <nav className="bg-slate-900 text-white sticky top-0 z-[100] shadow-xl">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between h-16 items-center">
            <div className="flex items-center gap-3">
              <CloudSun className="text-sky-400" size={28} />
              <span className="font-bold text-lg tracking-tight">115年度 氣象預算管理系統 <span className="text-xs bg-indigo-600 px-2 py-0.5 rounded ml-2 font-black">D版本</span></span>
            </div>
            <div className="hidden lg:flex space-x-8 text-sm font-bold">
              <a href="#summary" className="hover:text-sky-400 transition-colors">數據總覽</a>
              <a href="#strategic-view" className="hover:text-sky-400 transition-colors">重大計畫</a>
              <a href="#performance" className="hover:text-sky-400 transition-colors">組室績效</a>
              <a href="#qa-vault" className="hover:text-sky-400 transition-colors text-rose-300">攻防題庫</a>
            </div>
          </div>
        </div>
      </nav>

      {/* Header KPI Summary */}
      <header id="summary" className="py-10 bg-white border-b shadow-sm relative z-10">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            <div className="p-6 bg-slate-950 rounded-3xl text-white shadow-xl border-b-4 border-sky-500">
              <p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1">115 歲出概算總額</p>
              <p className="text-3xl font-black text-sky-400">3,004,946</p>
              <p className="text-[10px] text-slate-500 mt-1 font-bold italic">單位：千元 (主計室最終分配)</p>
            </div>
            <div className="p-6 bg-slate-100 rounded-3xl border border-slate-200 shadow-sm">
              <p className="text-[10px] font-bold text-slate-500 uppercase mb-1">114 歲出法定預算</p>
              <p className="text-3xl font-black text-slate-700">2,516,125</p>
              <p className="text-[10px] text-emerald-600 font-bold tracking-tight">預算年度成長率：19.43%</p>
            </div>
            <div className="p-6 bg-sky-50 rounded-3xl border border-sky-100 shadow-sm">
              <p className="text-[10px] font-bold text-sky-600 uppercase mb-1">年度經費總增額</p>
              <p className="text-3xl font-black text-sky-600">+488,821</p>
              <p className="text-[10px] text-sky-500 font-bold italic tracking-tight">含 114 年調薪與科技計畫</p>
            </div>
            <div className="p-6 bg-rose-50 rounded-3xl border border-rose-100 shadow-sm flex flex-col justify-center">
              <p className="text-[10px] font-bold text-rose-600 uppercase mb-1">審議風險監控</p>
              <p className="text-xl font-bold text-rose-700 leading-tight tracking-tight">370,500k 待審計畫</p>
              <p className="text-[10px] text-rose-500 mt-1 italic font-bold">需由立院同意後動支</p>
            </div>
          </div>
        </div>
      </header>

      {/* Strategic Project Dashboard (EXHAUSTIVE 9 PROJECTS) */}
      <section id="strategic-view" className="py-16 bg-slate-50 text-left">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="mb-10 border-l-8 border-indigo-600 pl-6 flex justify-between items-end">
            <div>
              <h2 className="text-3xl font-bold text-slate-900 flex items-center gap-3">
                <Microchip className="text-sky-600" /> 重大計畫看板 (含風險分析)
              </h2>
              <p className="mt-4 text-slate-600 font-medium max-w-2xl leading-relaxed italic border-l-4 border-slate-200 pl-4">
                深度整合 1224 財委會及次長會議資料。包含南部海纜、P7 科研及預算延宕風險說明。
              </p>
            </div>
            <div className="hidden md:block text-[10px] font-bold text-slate-400 bg-white px-4 py-2 rounded-full border shadow-sm uppercase tracking-widest">
              Total 9 Key Projects
            </div>
          </div>

          <div className="bg-white rounded-[2.5rem] shadow-2xl border border-slate-200 overflow-hidden flex flex-col lg:flex-row min-h-[780px]">
            <div className="lg:w-1/3 bg-slate-900 text-white p-6 flex flex-col">
              <div className="mb-6 p-2 font-bold text-slate-400 text-xs uppercase tracking-widest border-b border-slate-800 pb-4 text-center">關鍵計畫索引庫</div>
              <div className="space-y-2 flex-1 overflow-y-auto custom-scrollbar pr-2">
                {strategicProjects.map(p => (
                  <button 
                    key={p.id}
                    onClick={() => setActiveProject(p.id)}
                    className={`w-full text-left p-4 rounded-2xl border border-white/10 flex items-center gap-3 transition-all ${activeProject === p.id ? 'bg-sky-600 text-white border-sky-400 shadow-lg' : 'hover:bg-white/5 opacity-70 hover:opacity-100'}`}
                  >
                    <div className={`${activeProject === p.id ? 'text-white' : 'text-sky-400'}`}>{p.icon}</div>
                    <span className="text-xs font-bold leading-tight">{p.name}</span>
                  </button>
                ))}
              </div>
            </div>
            <div className="lg:w-2/3 p-10 bg-white overflow-y-auto custom-scrollbar relative">
              <div className="absolute top-6 right-10 text-[10px] text-slate-300 font-black italic">Ref: 1224 Financial Committee Doc</div>
              <div className="fade-in space-y-8">
                <div className="flex flex-col md:flex-row justify-between items-start gap-6">
                  <div className="flex-1">
                    <h3 className="text-2xl font-black text-slate-900 leading-tight">{currentProj.name}</h3>
                    <p className="text-slate-500 mt-2 font-medium">主責單位：{currentProj.owner} | <span className="text-sky-600 font-bold">115年度重點計畫</span></p>
                  </div>
                  <div className="bg-slate-900 text-white p-5 rounded-3xl text-center shadow-lg min-w-[160px]">
                    <p className="text-[9px] opacity-40 uppercase mb-1 tracking-widest">年度分配預算</p>
                    <p className="text-xl font-black text-sky-400">{currentProj.budget}</p>
                    <p className="text-[10px] opacity-60 font-bold italic">單位：千元</p>
                  </div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="bg-slate-50 p-6 rounded-3xl border border-slate-100 shadow-inner">
                    <h4 className="text-[10px] font-bold text-slate-400 uppercase mb-4 tracking-widest border-b pb-2">具體計畫工項與產出</h4>
                    <ul className="space-y-3">
                      {currentProj.works.map((w, idx) => (
                        <li key={idx} className="flex gap-2 text-xs text-slate-700 font-medium leading-relaxed">
                          <ChevronRight className="text-sky-500 flex-shrink-0" size={14} />
                          {w}
                        </li>
                      ))}
                    </ul>
                  </div>
                  <div className="bg-slate-800 p-6 rounded-3xl text-white shadow-xl flex flex-col justify-between">
                    <div><h4 className="text-[10px] font-bold text-sky-200 uppercase mb-3 tracking-widest">年度績效 (KPI)</h4><p className="text-3xl font-black">{currentProj.kpi}</p></div>
                    <div className="mt-6 bg-black/20 p-4 rounded-xl border border-white/10">
                      <h4 className="text-[10px] font-bold text-rose-300 uppercase mb-1 flex items-center gap-1"><ShieldAlert size={12} /> 預算延宕不利影響與風險評估</h4>
                      <p className="text-[11px] text-sky-50 leading-relaxed italic">{currentProj.risk}</p>
                    </div>
                  </div>
                </div>
                <div className="bg-blue-50 p-6 rounded-3xl border border-blue-100">
                  <h4 className="text-[10px] font-bold text-blue-500 uppercase mb-2 tracking-widest">核心施政預期效益</h4>
                  <p className="text-blue-900 text-sm font-bold leading-relaxed">「{currentProj.benefit}」</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Unit Explorer (NAV FIX) */}
      <section id="performance" className="py-20 bg-white border-y relative z-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-left">
          <div className="flex justify-between items-end mb-8">
            <div>
              <h2 className="text-3xl font-bold text-slate-900 mb-2">11 組室績效與決策深度庫</h2>
              <p className="text-slate-500 max-w-3xl leading-relaxed italic">
                整合 11 份組室簡報、1224 財委會質詢點。請左右滑動標籤切換所有單位，確保「南區」與「綜規」可見。
              </p>
            </div>
            <Info className="text-slate-300 mb-2" size={20} />
          </div>

          {/* 導航修復：確保捲軸到底時不切掉項目 */}
          <div className="bg-slate-100 rounded-2xl p-1 mb-8 overflow-hidden shadow-inner relative">
            <div id="unit-tabs-container" className="custom-scrollbar relative">
              {units.map(u => (
                <div key={u.id} className="tab-item">
                  <button 
                    onClick={() => setActiveTab(u.id)}
                    className={`tab-btn text-[13px] font-bold ${activeTab === u.id ? 'active-tab shadow-sm' : 'text-slate-500 opacity-70 hover:opacity-100'}`}
                  >
                    {u.icon} <span className="ml-1.5">{u.id}</span>
                  </button>
                </div>
              ))}
              {/* Padding Spacer for scroll-end visibility */}
              <div className="w-[100px] flex-shrink-0" aria-hidden="true"></div>
            </div>
          </div>
          
          <div id="unit-content-display" className="fade-in bg-white p-8 rounded-2xl border border-slate-200 shadow-sm grid grid-cols-1 lg:grid-cols-2 gap-10">
            <div className="space-y-6">
              <div>
                <span className="px-3 py-1 bg-sky-100 text-sky-700 rounded-lg text-[11px] font-bold tracking-wider">115 概算數：{currentUnit.budget_info}</span>
                <h3 className="text-2xl font-bold mt-4 tracking-tight">{currentUnit.id}：策略重點 (OKR)</h3>
                <p className="text-slate-600 font-medium text-base leading-relaxed mt-4 bg-slate-50 p-6 rounded-2xl border-l-4 border-l-sky-500 shadow-inner" dangerouslySetInnerHTML={{ __html: currentUnit.full_okr }}></p>
              </div>
              <div className="bg-emerald-50 p-6 rounded-2xl border border-emerald-100 shadow-sm leading-relaxed">
                <p className="text-emerald-900 font-bold italic text-[13px] flex items-center gap-2"><ChevronRight className="text-emerald-500" size={14} /> 核心預期效益分析</p>
                <p className="text-emerald-800 text-xs mt-2 font-medium">「{currentUnit.benefit}」</p>
              </div>
            </div>
            <div>
              <h4 className="text-[10px] font-bold text-slate-400 mb-6 uppercase tracking-widest">量化績效指標 (KPI)</h4>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6">
                {currentUnit.kpis.map((k, i) => (
                  <div key={i} className="bg-white p-4 rounded-2xl border border-slate-100 shadow-sm text-center transition-transform hover:scale-105">
                    <p className="text-2xl font-black text-sky-600 mb-1">{k.v}</p>
                    <p className="text-[9px] font-bold text-slate-400 uppercase tracking-widest leading-tight">{k.t}</p>
                  </div>
                ))}
              </div>
              <div className="overflow-hidden rounded-2xl border border-slate-200 shadow-sm">
                <div className="bg-slate-50 px-4 py-2 border-b text-[10px] font-bold text-slate-400 uppercase tracking-widest flex justify-between">
                  <span>深度決策明細與數據背景</span>
                  <span className="text-[9px] text-sky-400">Ref: 1224 Draft</span>
                </div>
                <table className="w-full">
                  <thead>
                    <tr className="bg-slate-50 border-b border-slate-200">
                      <th className="p-3 text-[11px] text-slate-500 w-1/3">重點科目/項目</th>
                      <th className="p-3 text-[11px] text-slate-500 text-left">數據與實務說明 (不精簡內容)</th>
                    </tr>
                  </thead>
                  <tbody>
                    {currentUnit.details.map((d, i) => (
                      <tr key={i} className="border-b border-slate-100 hover:bg-slate-50/50 transition-colors">
                        <td className="p-3 font-bold text-slate-700 text-xs">{d.k}</td>
                        <td className="p-3 text-slate-600 text-xs leading-relaxed">{d.v}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
              <p className="text-[10px] text-slate-400 mt-4 italic text-right font-medium italic border-t pt-2 border-slate-100">資料來源：{currentUnit.source}</p>
            </div>
          </div>
        </div>
      </section>

      {/* QA Archive (11 ITEMS FULL LIST - UNMODIFIED) */}
      <section id="qa-vault" className="py-20 bg-slate-50 relative z-10">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-left mb-16">
            <span className="bg-rose-100 text-rose-600 text-xs font-bold px-4 py-1.5 rounded-full uppercase tracking-widest tracking-widest">立法院 115 年度預擬答題庫 (不刪減全记录)</span>
            <h2 className="text-3xl font-bold text-slate-900 mt-4 tracking-tight">質詢攻防全記錄 (氣象法、南部海纜、退休潮)</h2>
            <p className="mt-4 text-slate-500 max-w-2xl italic text-sm leading-relaxed">
              同步收錄 1224 財委會最新質詢模擬題。涵蓋海纜流標、氣象法修正、出國計畫與大陸旅費所有邏輯細節。
            </p>
          </div>

          <div className="bg-white rounded-[2.5rem] border border-slate-200 shadow-2xl overflow-hidden flex flex-col md:flex-row h-[880px]">
            <div className="w-full md:w-1/3 border-r bg-slate-50 flex flex-col">
              <div className="p-4 border-b">
                <div className="relative">
                  <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" size={16} />
                  <input 
                    type="text" 
                    value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                    placeholder="搜尋議題關鍵字..." 
                    className="w-full pl-10 pr-4 py-4 rounded-xl border-2 border-slate-100 text-sm focus:ring-2 focus:ring-sky-500 outline-none shadow-inner"
                  />
                </div>
              </div>
              <div className="flex-1 overflow-y-auto custom-scrollbar bg-slate-50">
                {filteredQA.map(qa => (
                  <button 
                    key={qa.id}
                    onClick={() => setActiveQA(qa.id)}
                    className={`w-full text-left p-5 border-b transition-all group ${activeQA === qa.id ? 'qa-active bg-white' : 'hover:bg-white'}`}
                  >
                    <h4 className={`font-bold text-sm leading-snug ${activeQA === qa.id ? 'text-rose-600' : 'text-slate-800'}`}>{qa.title}</h4>
                    <p className="text-[9px] text-slate-400 mt-2 font-bold uppercase tracking-widest flex items-center gap-1 italic"><Info size={8} /> 來源檔案：{qa.source}</p>
                  </button>
                ))}
              </div>
            </div>
            <div className="w-full md:w-2/3 p-10 overflow-y-auto custom-scrollbar bg-white relative">
              <div className="absolute top-4 right-10 flex gap-2">
                <Zap className="text-yellow-400" size={16} />
                <span className="text-[10px] font-black text-slate-300 italic uppercase">CWA Quality Answer System v1.7</span>
              </div>
              <div className="fade-in space-y-8 text-left">
                <div>
                  <span className="px-3 py-1 bg-rose-100 text-rose-600 rounded-lg text-[10px] font-bold tracking-widest uppercase shadow-sm">{currentQA.source}</span>
                  <h3 className="text-3xl font-black mt-6 text-slate-900 leading-tight tracking-tight">{currentQA.title}</h3>
                  <div className="mt-6 bg-rose-50 p-8 rounded-3xl border border-rose-100 italic text-slate-700 font-bold text-base leading-relaxed shadow-inner">
                    <Info className="inline text-rose-400 mr-2" size={16} /> 質詢焦點：{currentQA.issue}
                  </div>
                </div>
                <div className="space-y-4">
                  <p className="text-lg font-bold text-slate-800 leading-relaxed italic border-l-8 border-slate-200 pl-6 bg-slate-50/50 py-4 rounded-r-2xl">模擬質詢問項：{currentQA.question}</p>
                </div>
                <div className="bg-slate-900 p-10 rounded-[3rem] text-white shadow-2xl border-t-8 border-sky-500 relative overflow-hidden group">
                  <div className="absolute -top-10 -right-10 p-8 opacity-5 text-white transform group-hover:scale-110 transition-transform"><ShieldAlert size={240} /></div>
                  <h4 className="text-xl font-bold mb-8 text-sky-400 flex items-center gap-3"><ShieldAlert className="animate-pulse" /> 署方官方答詢逻辑全記錄</h4>
                  <div className="text-slate-300 leading-relaxed text-base font-medium whitespace-pre-line border-l border-sky-500/30 pl-6">{currentQA.answer}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  );
};

export default App;
